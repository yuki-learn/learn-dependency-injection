

## オブジェクトの生存期間(lifetime)


* 破棄可能な抽象は漏洩する抽象になる
    * 短命な破棄可能オブジェクトを利用するクラスにそのまま注入すると、生存管理を利用する側が行わなくてはいけないので、注入してはいけない。
    ファクトリを注入して、生存管理をファクトリで行うようにする。
    * ※できるならそもそも破棄可能な抽象にすべきではない。


* 依存の解放(release)と依存の破棄(dispose)は同じじゃない。
    * 解放(release): どの依存を参照から外し、場合によっては破棄することができるのか、もしくはどの依存を生存させたままにするのか、ということを決定するプロセスのことである。その解放されたオブジェクトを破棄するのか、再利用するのかを決定する責務はコンポーザーが担う。



![1](img/1.png)
> *引用: Steven van Deursen 「なぜ依存を注入するのか DIの原理・原則とパターン」 p.308*


### 主な生存戦略(lifestyle)

|  名前 | 概要 | 
| ----- | ---- | 
|シングルトン生存戦略 (Singleton Lifestyle)|1つのインスタンスが何度も利用される| 
|   短命な生存戦略 (Transient Lifestyle)    |新しいインスタンスが常に提供される| 
|スコープ指定生存戦略 (Scoped Lifestyle)|暗黙的、もしくは明示的に定義されたスコープごとに各型のインスタンスが最大1つ提供される。|

※この他にも破棄可能なオブジェクトもある


### シングルトン生存戦略

Singletonパターンとは似て非なるもの。どちらも依存のインスタンスを1つだけ存在させるという点が同じ一方、Singletonパターンはどこからでもオブジェクトをアクセスできるようにしているのに対して、**シングルトン生存戦略はstaticなメソッドやプロパティを介してアクセスできないような仕組みにしている。**。